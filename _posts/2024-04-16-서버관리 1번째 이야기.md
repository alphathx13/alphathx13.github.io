---
title: 서버관리 1번째 이야기
date: 2024-04-16 12:00:00 +0800
categories: [Linux 서버 이야기]
tags: [linux, 서버관리, nginx, pure-ftpd, mariadb]
math: false
mermaid: true
image:
  path: assets/img/linux.png
---

<hr style="border:1px solid white">
[linux, nginx, 서버관리]

## 서버관리 이야기
```
여기 서버관리자인 `K`가 있다고 생각해보자

K는 새로운 서버를 오픈하고 이를 상업적으로 활용하려고 한다.

이를 위해 nginx 서버를 구축하고, 클라이언트들을 모집했고, 이때 A라는 클라이언트가 K의 서버를 사용하기로 계약하였다.

A는 'Test'라는 사이트를 오픈하기로 하였고, K는 Test에 대한 데이터를 nginx 서버에 업로드하였다.



K는 매번 A에게 사이트 변경내역을 받아서 업로드하는것이 번거롭다고 생각하였따
-> 그렇다고 K 자신의 nginx 서버 계정을 알려주자니, A가 서버의 root 권한을 가진다는것이 마음에 걸림
-> 그래서 A에게 자신의 사이트인 test에만 접근할 수 있는 계정을 만들어서 알려주기로 결정

이를 위해서 K는 pure-ftpd를 mariadb에 연동해서 계정을 관리하기로 결정
-> mariadb에 A가 자신의 사이트에 접근할 수 있는 계정을 생성하고 A에게 제공
-> 이제 K는 직접 수정사항을 업로드 하지않고, 이후 추가적인 클라이언트가 생겨도 추가 및 변경을 편하게 할수있음
```

<br/><br/>

## Rocky Linux 네트워크 시작하기
> ![111](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/20897852-e2d0-470a-9eb2-e8ddec931ceb){: .normal}
- 매번 포트포워딩하는것을 피하기 위해 호스트 전용 어댑터 설정

> ![111](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/73cd2973-48ee-4e33-933f-2ee2fb0a1a73)
- virtualbox의 호스트 전용 네트워크 셋팅에서 IPv4 값과 서브넷마스크를 기록

<br/><br/>

## 네트워크 셋팅
```bash
nmcli con show

nmcli con up enp0s3
nmcli con down enp0s3
```
> ![enp0s3](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/bd1c8bbe-e34d-4921-90e3-7c3ef907a542){: .normal}
- nmcli 명령어로 네트워크 인터페이스 관리
- enp0s3를 활성화
- 이때 Rocky linux 설치 이후에 virtualbox에서 호스트 전용 어댑터를 추가하거나 하는경우, enp0s8이 표시되지 않을 수 있음

<br/>

```bash
vi /etc/sysconfig/network-scripts/ifcfg-enp0s3
```
```vi
ONBOOT=yes
```
- NAT용 enp0s3의 네트워크 설정 변경 -> onboot 값을 부팅시 시작으로

<br/><br/>

## 호스트 전용 네트워크 셋팅
```bash
cd /etc/sysconfig/network-scripts
cp ifcfg-enp0s3 ifcfg-enp0s8
```
> ![111](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/ef7c99cc-6a3b-4456-9a02-5c7180168486){: .normal}
- enp0s8 설정파일이 존재하지 않기때문에 enp0s3 파일을 복사해서 enp0s8 생성

<br/>

```vi
vi enp0s8
```
> ![10](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/541d8a62-698b-4d94-b170-b8e6d819d106){: .normal}
- IPADDR은 위에서 확인한 호스트 전용 네트워크 셋팅에서 IPv4 값
- NETMASK는 서브넷마스크으로 입력

<br/>

```bash
systemctl start NetworkManager
ip addr
```
> ![111](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/61ed6686-290b-4e10-aeb8-fb51db0399de){: .normal}
- 네트워크를 재부팅하면 enp0s8이 작동되는것이 확인됨

<br/>

![11](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/fc8ed8ff-5c0c-434b-9dc9-03645fe96a93){: .normal}
- 이후 putty를 통해 192.168.56.101로 접속하면 

![111](https://github.com/alphathx13/alphathx13.github.io/assets/163115993/c1bd4204-65d2-4298-a5c2-a21ea5132f2c)
- 정상적으로 접속되는것을 확인할 수 있음